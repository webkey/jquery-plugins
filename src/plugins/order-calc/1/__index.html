@@include('../../../_tpl_layout_head.html', {
  "title": "Расчет количества и цены товаров при заказе. Наример, в корзине",
  "pathCss": ["js/jquery-ui/jquery-ui.css", "styles/main.css", "styles/theme.css"]
})

<div class="layout-flood user-content">

  <h1>Расчет количества и цены товаров при заказе. Наример, в корзине</h1>
  <h2>Пример с проекта Свитанок</h2>

  <p><i>* Примечание:</i> для работы спиннера (выбор количества товаров) нужно подключить jquery-ui.js и скопировать скрипт запрещающий ввод нечисловых значений в поле (/** only number input */)</p>

  <p>Цену указывать в data-price атрибуте элемента с ценой, например</p>
  <pre>&lt;div class="order-calc__price-js" data-price="40"&gt;40 р.&lt;/div&gt;</pre>

  <h2><span class="mark">Callback</span></h2>

  <h3>created</h3>
  <p>Вызов вконце функции init()</p>
  <pre>created: function () {}</pre>

  <h3>getTotalResults</h3>
  <p>После пересчета общего количества товаров и их суммарной цены</p>
  <pre>getTotalResults: function (e, el, results) {
    console.log("results: ", results);
  }</pre>
  <p>Параметры:</p>
  <ul>
    <li><i>results</i> - объект со значениями:
      <ul>
        <li><i>results.totalCount</i> - общее количество товаров</li>
        <li><i>results.totalPrice</i> - суммарная цена</li>
      </ul>
    </li>
  </ul>

  <h3>createdObjParams</h3>
  <p>После создания нового объекта продуктов по id и их параметро</p>
  <pre>createdObjParams: function (e, el, obj) {
    console.log("obj: ", obj);
  }</pre>
  <p>Параметры:</p>
  <ul>
    <li><i>obj</i> - объект с id продуктов</li>
  </ul>

  <h3>showedWarningRemoveItem</h3>
  <p>После того, как появляется уведомлении об удалении элемента (с возможностью отмены удаления). Событие происходит <b>после</b> пересчета общего результата (<b>после</b> события getTotalResults). Это можно использовать для блокировки кнопки отправки формы, пока "висит" предупреждение. См. в примере на этой странице. Параметр <i><b>warningRemove</b></i> должен иметь значение <i>true</i></p>
  <pre>showedWarningRemoveItem: function (e, el) {}</pre>

  <h3>canceledRemoveItem</h3>
  <p>После отмены удаления элемента. Событие происходит <b>до</b> пересчета общего результата (<b>до</b> события getTotalResults). Это можно использовать для блокировки кнопки отправки формы, пока "висит" предупреждение. См. в примере на этой странице. Параметр <i><b>warningRemove</b></i> должен иметь значение <i>true</i></p>
  <pre>showedWarningRemoveItem: function (e, el) {}</pre>

  <h3>removedItem</h3>
  <p>После удаления одного элемента.</p>
  <pre>removedItem: function (e, el) {}</pre>

  <h3>removedAllItems</h3>
  <p>После удаления всех элементов</p>
  <pre>removedAllItems: function (e, el) {}</pre>

  <h2>Дефолтные настройки</h2>
  <h3>Тable 1</h3>
  <div class="order-calc-js">
    <table class="c-table">
      <thead class="c-thead">
        <tr class="c-tr">
          @@include("_tpl_order-calc-head.html")
        </tr>
      </thead>
      <tbody class="c-tbody">
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 1",
          "src": "../../../img/temp/img_640_01.jpg",
          "price": {"val": "100.99", "unit": "$"},
          "priceOld": {"val": "200.99", "unit": "$"},
          "length": 1
          })
        </tr>
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 2",
          "src": "../../../img/temp/img_640_02.jpg",
          "price": {"val": "50.99", "unit": "$"},
          "priceOld": {"val": "100.99", "unit": "$"},
          "length": 1
          })
        </tr>
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 3",
          "src": "../../../img/temp/img_640_03.jpg",
          "price": {"val": "10.99", "unit": "$"},
          "priceOld": {"val": "20.99", "unit": "$"},
          "length": 1
          })
        </tr>
      </tbody>
      <tfoot class="order-calc__total-results-js">
        <tr class="c-tr">
          @@include("_tpl_order-calc-results.html")
        </tr>
      </tfoot>
    </table>
    <div class="order-calc__empty-js" style="display: none">Cart is empty</div>
  </div>
  <button class="order-calc__clear-js" disabled>Clear trigger</button>
  <br>

  <h3>Тable 2</h3>
  <div class="order-calc-js">
    <table class="c-table">
      <thead class="c-thead">
        <tr class="c-tr">
          @@include("_tpl_order-calc-head.html")
        </tr>
      </thead>
      <tbody class="c-tbody">
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 1",
          "src": "../../../img/temp/img_640_01.jpg",
          "price": {"val": "100.99", "unit": "$"},
          "priceOld": {"val": "200.99", "unit": "$"},
          "length": 1
          })
        </tr>
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 2",
          "src": "../../../img/temp/img_640_02.jpg",
          "price": {"val": "50.99", "unit": "$"},
          "priceOld": {"val": "100.99", "unit": "$"},
          "length": 1
          })
        </tr>
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 3",
          "src": "../../../img/temp/img_640_03.jpg",
          "price": {"val": "10.99", "unit": "$"},
          "priceOld": {"val": "20.99", "unit": "$"},
          "length": 1
          })
        </tr>
      </tbody>
      <tfoot class="order-calc__total-results-js">
        <tr class="c-tr">
          @@include("_tpl_order-calc-results.html")
        </tr>
      </tfoot>
    </table>
    <div class="order-calc__empty-js" style="display: none">Cart is empty</div>
  </div>
  <button class="order-calc__clear-js" disabled>Clear trigger</button>
  <br>

  <h2>Динамически добавленная таблица</h2>
  <div id="orderCalcCreate">
    <!--ajax template-->
  </div>
  <br>

  <h2>Плагин инициализируется через другой класс</h2>
  <div class="order-calc-js--alt">
    <table class="c-table">
      <thead class="c-thead">
        <tr class="c-tr">
          @@include("_tpl_order-calc-head.html")
        </tr>
      </thead>
      <tbody class="c-tbody">
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 1",
          "src": "../../../img/temp/img_640_01.jpg",
          "price": {"val": "100.99", "unit": "$"},
          "priceOld": {"val": "200.99", "unit": "$"},
          "length": 1
          })
        </tr>
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 2",
          "src": "../../../img/temp/img_640_02.jpg",
          "price": {"val": "50.99", "unit": "$"},
          "priceOld": {"val": "100.99", "unit": "$"},
          "length": 1
          })
        </tr>
        <tr class="c-tr">
          @@include("_tpl_order-calc-item.html", {
          "href": "#",
          "title": "Product 3",
          "src": "../../../img/temp/img_640_03.jpg",
          "price": {"val": "10.99", "unit": "$"},
          "priceOld": {"val": "20.99", "unit": "$"},
          "length": 1
          })
        </tr>
      </tbody>
      <tfoot class="order-calc__total-results-js">
        <tr class="c-tr">
          @@include("_tpl_order-calc-results.html")
        </tr>
      </tfoot>
    </table>
    <div class="order-calc__empty-js" style="display: none">Cart is empty</div>
  </div>
  <button class="order-calc__clear-js" disabled>Clear trigger</button>
  <br>

</div>

@@include('../../../_tpl_layout_foot.html', {
  "pathJs": ["js/jquery-ui/jquery-ui.min.js", "js/jquery.order-calc.js", "js/example.js"]
})