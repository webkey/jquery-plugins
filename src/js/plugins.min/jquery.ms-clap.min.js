var TOUCH=Modernizr.touchevents,DESKTOP=!TOUCH;!function(e){"use strict";var t=function(t,i){var a=e(t),n=e("html"),s=e(i.panel,a),r=!1,o="input, a, [tabindex], area, select, textarea, button, [contentEditable=true]"+i.hand,l=a.attr("data-clap-collapsed"),c="true"===l||"false"===l?"true"===l:i.collapsed,p=function(){e.each(i,function(e,t){"function"==typeof t&&a.on("msClap."+e,function(e,i){return t(e,a,i)})})},f=function(e){e.attr("tabindex","0")},u=function(e){e.attr("tabindex","-1")},d=function(t){if(t.length){a.trigger("msClap.beforeOpen"),i.accessibility&&(f(e(o,t)),u(e(o,t.find(i.panel).filter(function(){return e(this).data("active")})))),t.closest(i.item).addClass(i.modifiers.activeClass);var n=arguments[1];if(t.parentsUntil(a,i.panel+":hidden").show().data("active",!0).attr("data-active",!0).end().parentsUntil(a,i.item).addClass(i.modifiers.activeClass).end().slideDown(i.animationSpeed,function(){e(this).data("active",!0).attr("data-active",!0),a.trigger("msClap.afterOpen"),"function"==typeof n&&n()}),c){var s=t.parentsUntil(a,i.item).siblings().find(i.panel).filter(function(){return e(this).data("active")});m(s,function(){r=!1})}}},m=function(t){if(t.length){if(i.accessibility&&u(e(o,t)),c){var n=e(i.panel,t).filter(function(){return e(this).data("active")});v(n)}a.trigger("msClap.beforeClose");var s=arguments[1];v(t,function(){a.trigger("msClap.afterClose"),"function"==typeof s&&s()})}},v=function(t){var n=arguments[1];t.closest(i.item).removeClass(i.modifiers.activeClass),t.slideUp(i.animationSpeed,function(){e(this).data("active",!1).attr("data-active",!1),a.trigger("msClap.afterEachClose"),"function"==typeof n&&n()})},C=function(){e(i.hand).on(i.event,function(t){if(r)return t.preventDefault(),!1;var a=e(this);if(!a.closest(i.item).has(i.panel).length)return!1;r=!0,t.preventDefault();var n=a.closest(i.header).next(i.panel);n.data("active")?m(n,function(){r=!1}):d(n,function(){r=!1})})};return{callbacks:p,open:d,close:m,events:C,hover:function(){if(i.customHover.turnOn){var t="hoverTimeout",n="hoverIntent";a.on("mouseenter",i.hover.element,function(){var a=e(this);a.prop(t)&&a.prop(t,clearTimeout(a.prop(t))),a.prop(n,setTimeout(function(){a.addClass(i.customHover.modifiers.current),a.prev().addClass(i.customHover.modifiers.prev),a.next().addClass(i.customHover.modifiers.next)},i.customHover.timeout))}).on("mouseleave",function(){var a=e(this);a.prop(n)&&a.prop(n,clearTimeout(a.prop(n))),a.prop(t,setTimeout(function(){a.removeClass(i.customHover.modifiers.current),a.prev().removeClass(i.customHover.modifiers.prev),a.next().removeClass(i.customHover.modifiers.next)},i.customHover.timeout))})}},enterClick:function(){i.accessibility&&n.keyup(function(t){13===t.keyCode&&e(i.hand).filter(":focus").trigger("click")})},init:function(){var t=s.filter(":visible");t.addClass(i.modifiers.activeClass).data("active",!0).attr("data-active",!0),t.closest(i.item).addClass(i.modifiers.activeClass),i.accessibility&&(f(e(i.hand,a)),u(e(o,s)),f(e(o,t))),a.addClass(i.modifiers.init),a.trigger("msClap.afterInit")}}};e.fn.msClap=function(){var i,a,n=this,s=arguments[0],r=Array.prototype.slice.call(arguments,1),o=n.length;for(i=0;i<o;i++)if("object"==typeof s||void 0===s?(n[i].msClap=new t(n[i],e.extend(!0,{},e.fn.msClap.defaultOptions,s)),n[i].msClap.init(),n[i].msClap.callbacks(),n[i].msClap.events(),n[i].msClap.hover(),n[i].msClap.enterClick()):a=n[i].msClap[s].apply(n[i].msClap,r),void 0!==a)return a;return n},e.fn.msClap.defaultOptions={item:".msClap__item-js",header:".msClap__header-js",hand:".msClap__hand-js",panel:".msClap__panel-js",event:"click",animationSpeed:300,collapsed:!0,accessibility:!1,modifiers:{init:"msClap_initialized",activeClass:"is-open"},customHover:{turnOn:!1,element:".msClap__item-js",timeout:50,modifiers:{current:"hover",next:"hover-next",prev:"hover-prev"}}}}(jQuery);